
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A structured meta-repository for learning systems engineering, embedded Linux, and infrastructure automation">
      
      
        <meta name="author" content="Jofralso">
      
      
        <link rel="canonical" href="https://jofralso.github.io/hitchhikers-guide-to-developing/labs/debugging/lab25-kernel-debugging/">
      
      
        <link rel="prev" href="../lab24-ebpf-bcc/">
      
      
        <link rel="next" href="../lab26-kdump-kexec/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Lab 25 - Kernel Debugging - The Hitchhiker's Guide to Developing</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-25-kernel-debugging-and-oops-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="The Hitchhiker&#39;s Guide to Developing" class="md-header__button md-logo" aria-label="The Hitchhiker's Guide to Developing" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Hitchhiker's Guide to Developing
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 25 - Kernel Debugging
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Jofralso/hitchhikers-guide-to-developing" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Jofralso/hitchhikers-guide-to-developing
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../QUICK_START/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../embedded-linux/" class="md-tabs__link">
          
  
  
  Labs

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../THE-JOURNEY/" class="md-tabs__link">
        
  
  
    
  
  The Journey

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../ROADMAP/" class="md-tabs__link">
        
  
  
    
  
  Roadmap

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../ARCHITECTURE/" class="md-tabs__link">
        
  
  
    
  
  Architecture

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../BIBLIOGRAPHY/" class="md-tabs__link">
        
  
  
    
  
  Bibliography

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../submodules/index.md" class="md-tabs__link">
          
  
  
  Submodules

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../templates/lab-template/" class="md-tabs__link">
          
  
  
  Templates

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../standards/documentation-standards/" class="md-tabs__link">
          
  
  
  Standards

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../CONTRIBUTING/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="The Hitchhiker&#39;s Guide to Developing" class="md-nav__button md-logo" aria-label="The Hitchhiker's Guide to Developing" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    The Hitchhiker's Guide to Developing
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Jofralso/hitchhikers-guide-to-developing" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Jofralso/hitchhikers-guide-to-developing
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../QUICK_START/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BEAGLEPLAY_SETUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BeaglePlay Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LAB_STRUCTURE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Embedded Linux
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Embedded Linux
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/lab01-toolchain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 1 - Toolchain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/lab02-hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 2 - Hardware Discovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/lab03-bootloader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 3 - U-Boot Bootloader
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/lab04-kernel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 4 - Linux Kernel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/lab05-rootfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 5 - Root Filesystem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/lab06-hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 6 - Hardware Devices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/lab07-block-filesystems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 7 - Block Filesystems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/lab08-buildroot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 8 - Buildroot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded-linux/lab09-application-development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 9 - App Development
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Yocto Project
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Yocto Project
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/lab10-yocto-first-build/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 10 - First Yocto Build
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/lab11-yocto-advanced-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 11 - Advanced Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/lab12-yocto-custom-app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 12 - Custom Application
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/lab13-yocto-custom-layer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 13 - Custom Layer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/lab14-yocto-extend-recipe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 14 - Extend Recipe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/lab15-yocto-custom-machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 15 - Custom Machine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/lab16-yocto-custom-image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 16 - Custom Image
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/lab17-yocto-app-development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 17 - SDK Development
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../yocto/lab18-yocto-devtool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 18 - Devtool
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Debugging
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab19-system-monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 19 - System Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab20-gdb-debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 20 - GDB Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab21-strace-ltrace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 21 - strace/ltrace
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab22-valgrind/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 22 - Valgrind
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab23-perf-ftrace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 23 - perf & ftrace
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab24-ebpf-bcc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 24 - eBPF & BCC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Lab 25 - Kernel Debugging
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 25 - Kernel Debugging
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dont-panic" class="md-nav__link">
    <span class="md-ellipsis">
      
        DON'T PANIC
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objectives" class="md-nav__link">
    <span class="md-ellipsis">
      
        Objectives
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-understanding-kernel-oops" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Understanding Kernel OOPS
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Understanding Kernel OOPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-what-is-a-kernel-oops" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 What is a Kernel OOPS?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-example-oops-message" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 Example OOPS Message
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-decode-oops" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 Decode OOPS
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-kernel-debugging-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Kernel Debugging Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Kernel Debugging Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-essential-debug-configs" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Essential Debug Configs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-enable-in-yocto" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Enable in Yocto
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-enable-in-buildroot" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 Enable in Buildroot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-lock-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Lock Debugging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Lock Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-prove_locking-lockdep" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 PROVE_LOCKING (Lockdep)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-debug_atomic_sleep" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 DEBUG_ATOMIC_SLEEP
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-memory-leak-detection-with-kmemleak" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Memory Leak Detection with kmemleak
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Memory Leak Detection with kmemleak">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-enable-kmemleak" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Enable kmemleak
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-trigger-scan" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Trigger Scan
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-interactive-kernel-debugging-with-kgdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Interactive Kernel Debugging with KGDB
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Interactive Kernel Debugging with KGDB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-configure-kgdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Configure KGDB
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-connect-gdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 Connect GDB
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-set-breakpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 Set Breakpoints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-examine-kernel-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 Examine Kernel State
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-magic-sysrq-for-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Magic SysRq for Debugging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Magic SysRq for Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-enable-magic-sysrq" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1 Enable Magic SysRq
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-useful-sysrq-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2 Useful SysRq Commands
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-crash-dump-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Crash Dump Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Crash Dump Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-decode-code-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.1 Decode Code Bytes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-analyze-with-crash-utility" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.2 Analyze with crash Utility
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-debugging-kernel-modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Debugging Kernel Modules
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Debugging Kernel Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-load-module-with-debug-symbols" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.1 Load Module with Debug Symbols
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-printk-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.2 printk Debugging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-real-world-debugging-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Real-World Debugging Example
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Real-World Debugging Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-scenario-system-hangs" class="md-nav__link">
    <span class="md-ellipsis">
      
        9.1 Scenario: System Hangs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-fix-and-verify" class="md-nav__link">
    <span class="md-ellipsis">
      
        9.2 Fix and Verify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-kernel-sanitizers" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. Kernel Sanitizers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. Kernel Sanitizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-kasan-kernel-address-sanitizer" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.1 KASAN (Kernel Address Sanitizer)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-ubsan-undefined-behavior-sanitizer" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.2 UBSAN (Undefined Behavior Sanitizer)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-troubleshooting-tips" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. Troubleshooting Tips
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. Troubleshooting Tips">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111-system-wont-boot" class="md-nav__link">
    <span class="md-ellipsis">
      
        11.1 System Won't Boot
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112-intermittent-crashes" class="md-nav__link">
    <span class="md-ellipsis">
      
        11.2 Intermittent Crashes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      
        12. Key Takeaways
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-verification-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. Verification Checklist
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab26-kdump-kexec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 26 - kdump & kexec
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../THE-JOURNEY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Journey
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ROADMAP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ARCHITECTURE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BIBLIOGRAPHY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bibliography
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Submodules
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Submodules
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../submodules/index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Templates
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Templates
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../templates/lab-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab Template
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../templates/research-note/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Research Note
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../templates/technical-procedure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Technical Procedure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Standards
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Standards
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../standards/documentation-standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dont-panic" class="md-nav__link">
    <span class="md-ellipsis">
      
        DON'T PANIC
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objectives" class="md-nav__link">
    <span class="md-ellipsis">
      
        Objectives
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-understanding-kernel-oops" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Understanding Kernel OOPS
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Understanding Kernel OOPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-what-is-a-kernel-oops" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 What is a Kernel OOPS?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-example-oops-message" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 Example OOPS Message
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-decode-oops" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 Decode OOPS
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-kernel-debugging-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Kernel Debugging Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Kernel Debugging Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-essential-debug-configs" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Essential Debug Configs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-enable-in-yocto" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Enable in Yocto
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-enable-in-buildroot" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 Enable in Buildroot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-lock-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Lock Debugging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Lock Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-prove_locking-lockdep" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 PROVE_LOCKING (Lockdep)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-debug_atomic_sleep" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 DEBUG_ATOMIC_SLEEP
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-memory-leak-detection-with-kmemleak" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Memory Leak Detection with kmemleak
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Memory Leak Detection with kmemleak">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-enable-kmemleak" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Enable kmemleak
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-trigger-scan" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Trigger Scan
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-interactive-kernel-debugging-with-kgdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Interactive Kernel Debugging with KGDB
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Interactive Kernel Debugging with KGDB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-configure-kgdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Configure KGDB
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-connect-gdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 Connect GDB
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-set-breakpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 Set Breakpoints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-examine-kernel-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 Examine Kernel State
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-magic-sysrq-for-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Magic SysRq for Debugging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Magic SysRq for Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-enable-magic-sysrq" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1 Enable Magic SysRq
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-useful-sysrq-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2 Useful SysRq Commands
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-crash-dump-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Crash Dump Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Crash Dump Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-decode-code-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.1 Decode Code Bytes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-analyze-with-crash-utility" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.2 Analyze with crash Utility
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-debugging-kernel-modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Debugging Kernel Modules
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Debugging Kernel Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-load-module-with-debug-symbols" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.1 Load Module with Debug Symbols
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-printk-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      
        8.2 printk Debugging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-real-world-debugging-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Real-World Debugging Example
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Real-World Debugging Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-scenario-system-hangs" class="md-nav__link">
    <span class="md-ellipsis">
      
        9.1 Scenario: System Hangs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-fix-and-verify" class="md-nav__link">
    <span class="md-ellipsis">
      
        9.2 Fix and Verify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-kernel-sanitizers" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. Kernel Sanitizers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. Kernel Sanitizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-kasan-kernel-address-sanitizer" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.1 KASAN (Kernel Address Sanitizer)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-ubsan-undefined-behavior-sanitizer" class="md-nav__link">
    <span class="md-ellipsis">
      
        10.2 UBSAN (Undefined Behavior Sanitizer)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-troubleshooting-tips" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. Troubleshooting Tips
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. Troubleshooting Tips">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111-system-wont-boot" class="md-nav__link">
    <span class="md-ellipsis">
      
        11.1 System Won't Boot
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112-intermittent-crashes" class="md-nav__link">
    <span class="md-ellipsis">
      
        11.2 Intermittent Crashes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      
        12. Key Takeaways
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-verification-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. Verification Checklist
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="lab-25-kernel-debugging-and-oops-analysis">Lab 25: Kernel Debugging and OOPS Analysis<a class="headerlink" href="#lab-25-kernel-debugging-and-oops-analysis" title="Permanent link">&para;</a></h1>
<h2 id="dont-panic">DON'T PANIC<a class="headerlink" href="#dont-panic" title="Permanent link">&para;</a></h2>
<p>The Hitchhiker's Guide to Embedded Linux has this to say about the Linux kernel:</p>
<p><em>"The Linux kernel is the brain of your embedded system. Unlike certain galactic presidents, it's actually quite good at multitasking, managing hardware, and not generally causing chaos. Though both occasionally crash when faced with infinite improbability."</em></p>
<h2 id="objectives">Objectives<a class="headerlink" href="#objectives" title="Permanent link">&para;</a></h2>
<p>Master kernel debugging techniques including KGDB for interactive debugging, analyzing kernel OOPS messages, using kernel debugging configs, and detecting kernel bugs with sanitizers.</p>
<p><strong>What You'll Learn:</strong>
- Analyze kernel OOPS and panic messages
- Use KGDB for interactive kernel debugging
- Enable kernel debugging options (PROVE_LOCKING, DEBUG_ATOMIC_SLEEP)
- Detect memory leaks with kmemleak
- Debug deadlocks and race conditions
- Understand kernel stack traces</p>
<p><strong>Time Required:</strong> 4-5 hours</p>
<hr />
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p><strong>Hardware:</strong>
- BeaglePlay board
- USB-to-Serial adapter (for KGDB)
- Development workstation</p>
<p><strong>Software:</strong>
- Kernel compiled with debugging symbols
- GDB with ARM64 support
- Serial console access</p>
<hr />
<h2 id="1-understanding-kernel-oops">1. Understanding Kernel OOPS<a class="headerlink" href="#1-understanding-kernel-oops" title="Permanent link">&para;</a></h2>
<h3 id="11-what-is-a-kernel-oops">1.1 What is a Kernel OOPS?<a class="headerlink" href="#11-what-is-a-kernel-oops" title="Permanent link">&para;</a></h3>
<p><strong>OOPS</strong> = kernel detected internal error but can continue running.
<strong>Panic</strong> = fatal error, kernel halts.</p>
<p><strong>Common causes:</strong>
- NULL pointer dereference
- Invalid memory access
- Stack corruption
- Division by zero in kernel code</p>
<h3 id="12-example-oops-message">1.2 Example OOPS Message<a class="headerlink" href="#12-example-oops-message" title="Permanent link">&para;</a></h3>
<p><strong>Trigger OOPS with buggy module:</strong></p>
<p><strong>Create <code>oops_module.c</code>:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;linux/module.h&gt;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;linux/kernel.h&gt;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">__init</span><span class="w"> </span><span class="nf">oops_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span><span class="w"> </span><span class="s">&quot;About to OOPS...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="o">*</span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span><span class="w">  </span><span class="c1">// NULL pointer dereference!</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">}</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__exit</span><span class="w"> </span><span class="nf">oops_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">    </span><span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span><span class="w"> </span><span class="s">&quot;Exiting (never reached)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">}</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">module_init</span><span class="p">(</span><span class="n">oops_init</span><span class="p">);</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">module_exit</span><span class="p">(</span><span class="n">oops_exit</span><span class="p">);</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>Makefile:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nv">obj-m</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span>oops_module.o
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nf">all</span><span class="o">:</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span>make<span class="w"> </span>-C<span class="w"> </span>/lib/modules/<span class="k">$(</span>shell<span class="w"> </span>uname<span class="w"> </span>-r<span class="k">)</span>/build<span class="w"> </span><span class="nv">M</span><span class="o">=</span><span class="k">$(</span>PWD<span class="k">)</span><span class="w"> </span>modules
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nf">clean</span><span class="o">:</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span>make<span class="w"> </span>-C<span class="w"> </span>/lib/modules/<span class="k">$(</span>shell<span class="w"> </span>uname<span class="w"> </span>-r<span class="k">)</span>/build<span class="w"> </span><span class="nv">M</span><span class="o">=</span><span class="k">$(</span>PWD<span class="k">)</span><span class="w"> </span>clean
</code></pre></div></p>
<p><strong>Build and load:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>make
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>sudo<span class="w"> </span>insmod<span class="w"> </span>oops_module.ko
</code></pre></div></p>
<p><strong>OOPS output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>Mem abort info:
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>  ESR = 0x96000045
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  EC = 0x25: DABT (current EL), IL = 32 bits
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>  SET = 0, FnV = 0
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>  EA = 0, S1PTW = 0
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>Data abort info:
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>  ISV = 0, ISS = 0x00000045
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>  CM = 0, WnR = 1
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>user pgtable: 4k pages, 48-bit VAs, pgdp=000000008a123000
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>[0000000000000000] pgd=0000000000000000, p4d=0000000000000000
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>Internal error: Oops: 96000045 [#1] SMP
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>Modules linked in: oops_module(O+) [last unloaded: oops_module]
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>CPU: 0 PID: 567 Comm: insmod Tainted: G           O      5.10.0 #1
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>Hardware name: BeaglePlay (DT)
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>pstate: 60000005 (nZCv daif -PAN -UAO -TCO BTYPE=--)
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>pc : oops_init+0x14/0x1000 [oops_module]
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>lr : do_one_initcall+0x50/0x230
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>sp : ffff800012a3bd10
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>x29: ffff800012a3bd10 x28: 0000000000000000 
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>x27: ffff0000c1234000 x26: ffff800011234000
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>...
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>Call trace:
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a> oops_init+0x14/0x1000 [oops_module]
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a> do_one_initcall+0x50/0x230
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a> do_init_module+0x60/0x240
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a> load_module+0x1abc/0x1d00
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a> __do_sys_finit_module+0xac/0x100
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a> __arm64_sys_finit_module+0x20/0x30
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a> el0_svc_common.constprop.0+0x78/0x1c0
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a> do_el0_svc+0x24/0x90
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a> el0_svc+0x14/0x20
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a> el0_sync_handler+0xb0/0xc0
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a> el0_sync+0x180/0x1c0
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>Code: d2800000 d503201f 910003fd f9001fe0 (b9000000)
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>---[ end trace 123456789abcdef ]---
</code></pre></div></p>
<h3 id="13-decode-oops">1.3 Decode OOPS<a class="headerlink" href="#13-decode-oops" title="Permanent link">&para;</a></h3>
<p><strong>Key information:</strong>
1. <strong>Fault address</strong>: <code>0000000000000000</code> (NULL)
2. <strong>PC</strong> (Program Counter): <code>oops_init+0x14</code> (crash location)
3. <strong>Call trace</strong>: Shows function call chain
4. <strong>Tainted</strong>: <code>O</code> = out-of-tree module
5. <strong>Code</strong>: Bytes at crash site</p>
<p><strong>Decode with addr2line:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>addr2line<span class="w"> </span>-e<span class="w"> </span>oops_module.ko<span class="w"> </span>oops_init+0x14
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c1"># oops_module.c:7</span>
</code></pre></div></p>
<p><strong>Shows line 7:</strong> <code>*ptr = 42;</code></p>
<hr />
<h2 id="2-kernel-debugging-configuration">2. Kernel Debugging Configuration<a class="headerlink" href="#2-kernel-debugging-configuration" title="Permanent link">&para;</a></h2>
<h3 id="21-essential-debug-configs">2.1 Essential Debug Configs<a class="headerlink" href="#21-essential-debug-configs" title="Permanent link">&para;</a></h3>
<p><strong>In kernel <code>.config</code>:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a># Basic debugging
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>CONFIG_DEBUG_KERNEL=y
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>CONFIG_DEBUG_INFO=y
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>CONFIG_DEBUG_INFO_DWARF4=y
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a># Stack traces
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>CONFIG_STACKTRACE=y
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>CONFIG_FRAME_POINTER=y
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a># Memory debugging
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>CONFIG_SLUB_DEBUG=y
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>CONFIG_DEBUG_KMEMLEAK=y
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a># Lock debugging
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>CONFIG_PROVE_LOCKING=y
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>CONFIG_DEBUG_ATOMIC_SLEEP=y
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>CONFIG_DEBUG_MUTEXES=y
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>CONFIG_DEBUG_SPINLOCK=y
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a># Additional checks
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>CONFIG_DEBUG_LIST=y
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>CONFIG_DEBUG_OBJECTS=y
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>CONFIG_DEBUG_VM=y
</code></pre></div></p>
<h3 id="22-enable-in-yocto">2.2 Enable in Yocto<a class="headerlink" href="#22-enable-in-yocto" title="Permanent link">&para;</a></h3>
<p><strong>In <code>local.conf</code> or machine config:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>KERNEL_DEBUG_ENABLE = &quot;1&quot;
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>KERNEL_FEATURES:append = &quot; features/debug/printk.scc features/debug/debug-kernel.scc&quot;
</code></pre></div></p>
<p><strong>Or manually:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>bitbake<span class="w"> </span>-c<span class="w"> </span>menuconfig<span class="w"> </span>virtual/kernel
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c1"># Kernel hacking  [*] Kernel debugging</span>
</code></pre></div></p>
<h3 id="23-enable-in-buildroot">2.3 Enable in Buildroot<a class="headerlink" href="#23-enable-in-buildroot" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>make<span class="w"> </span>linux-menuconfig
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="c1"># Kernel hacking  [*] Kernel debugging</span>
</code></pre></div>
<hr />
<h2 id="3-lock-debugging">3. Lock Debugging<a class="headerlink" href="#3-lock-debugging" title="Permanent link">&para;</a></h2>
<h3 id="31-prove_locking-lockdep">3.1 PROVE_LOCKING (Lockdep)<a class="headerlink" href="#31-prove_locking-lockdep" title="Permanent link">&para;</a></h3>
<p><strong>Detects:</strong>
- Lock inversion (AB-BA deadlock)
- Lock held too long
- Incorrect lock usage</p>
<p><strong>Example deadlock:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">// Thread 1:</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock_a</span><span class="p">);</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock_b</span><span class="p">);</span><span class="w">  </span><span class="c1">// AB order</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock_b</span><span class="p">);</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock_a</span><span class="p">);</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c1">// Thread 2:</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock_b</span><span class="p">);</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock_a</span><span class="p">);</span><span class="w">  </span><span class="c1">// BA order - DEADLOCK!</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock_a</span><span class="p">);</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lock_b</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>Lockdep output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>======================================================
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>WARNING: possible circular locking dependency detected
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>======================================================
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>task_a/567 is trying to acquire lock:
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>ffff0000c1234000 (lock_b){+.+.}, at: thread_func+0x34/0x100
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>but task is already holding lock:
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>ffff0000c5678000 (lock_a){+.+.}, at: thread_func+0x24/0x100
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>which lock already depends on the new lock:
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>the existing dependency chain (in reverse order) is:
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>-&gt; #1 (lock_a){+.+.}:
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>       lock_acquire+0xd0/0x200
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>       _mutex_lock+0x80/0x100
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>       thread_func+0x24/0x100
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>-&gt; #0 (lock_b){+.+.}:
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>       lock_acquire+0xd0/0x200
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>       _mutex_lock+0x80/0x100
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>       thread_func+0x34/0x100
</code></pre></div></p>
<p><strong>Fix:</strong> Always acquire locks in same order.</p>
<h3 id="32-debug_atomic_sleep">3.2 DEBUG_ATOMIC_SLEEP<a class="headerlink" href="#32-debug_atomic_sleep" title="Permanent link">&para;</a></h3>
<p><strong>Detects sleeping in atomic context:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">spinlock_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_lock</span><span class="p">);</span><span class="w">  </span><span class="c1">// Atomic context</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">msleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span><span class="w">              </span><span class="c1">// BUG: Sleep in atomic!</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">spinlock_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_lock</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>Error message:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>BUG: sleeping function called from invalid context at kernel/time/timer.c:1234
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>in_atomic(): 1, irqs_disabled(): 0, pid: 567, name: my_task
</code></pre></div></p>
<hr />
<h2 id="4-memory-leak-detection-with-kmemleak">4. Memory Leak Detection with kmemleak<a class="headerlink" href="#4-memory-leak-detection-with-kmemleak" title="Permanent link">&para;</a></h2>
<h3 id="41-enable-kmemleak">4.1 Enable kmemleak<a class="headerlink" href="#41-enable-kmemleak" title="Permanent link">&para;</a></h3>
<p><strong>Kernel config:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>CONFIG_DEBUG_KMEMLEAK=y
</code></pre></div></p>
<p><strong>Boot parameter:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a># In bootargs
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>kmemleak=on
</code></pre></div></p>
<h3 id="42-trigger-scan">4.2 Trigger Scan<a class="headerlink" href="#42-trigger-scan" title="Permanent link">&para;</a></h3>
<p><strong>Create leaky module:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;linux/module.h&gt;</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;linux/slab.h&gt;</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">__init</span><span class="w"> </span><span class="nf">leak_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kmalloc</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="n">GFP_KERNEL</span><span class="p">);</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="n">printk</span><span class="p">(</span><span class="s">&quot;Allocated but not freed: %p</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">);</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="c1">// Missing kfree(ptr)!</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="p">}</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="n">module_init</span><span class="p">(</span><span class="n">leak_init</span><span class="p">);</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>Load module:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>insmod<span class="w"> </span>leak_module.ko
</code></pre></div></p>
<p><strong>Scan for leaks:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="nb">echo</span><span class="w"> </span>scan<span class="w"> </span>&gt;<span class="w"> </span>/sys/kernel/debug/kmemleak
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>cat<span class="w"> </span>/sys/kernel/debug/kmemleak
</code></pre></div></p>
<p><strong>Output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>unreferenced object 0xffff0000c1234000 (size 1024):
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>  comm &quot;insmod&quot;, pid 567, jiffies 4294937296 (age 123.456s)
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>  hex dump (first 32 bytes):
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>  backtrace:
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    [&lt;ffff800010123456&gt;] kmalloc_trace+0x80/0x100
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    [&lt;ffff800011234567&gt;] leak_init+0x20/0x1000 [leak_module]
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>    [&lt;ffff800010345678&gt;] do_one_initcall+0x50/0x230
</code></pre></div></p>
<p><strong>Shows allocation backtrace</strong> to find leak source.</p>
<hr />
<h2 id="5-interactive-kernel-debugging-with-kgdb">5. Interactive Kernel Debugging with KGDB<a class="headerlink" href="#5-interactive-kernel-debugging-with-kgdb" title="Permanent link">&para;</a></h2>
<h3 id="51-configure-kgdb">5.1 Configure KGDB<a class="headerlink" href="#51-configure-kgdb" title="Permanent link">&para;</a></h3>
<p><strong>Kernel config:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>CONFIG_KGDB=y
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>CONFIG_KGDB_SERIAL_CONSOLE=y
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>CONFIG_MAGIC_SYSRQ=y
</code></pre></div></p>
<p><strong>Boot parameters:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>kgdboc=ttyS0,115200 kgdbwait
</code></pre></div></p>
<p><strong>Options:</strong>
- <code>kgdboc</code>: KGDB over console (serial port)
- <code>kgdbwait</code>: Wait for debugger at boot</p>
<h3 id="52-connect-gdb">5.2 Connect GDB<a class="headerlink" href="#52-connect-gdb" title="Permanent link">&para;</a></h3>
<p><strong>On BeaglePlay (boots and waits):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>KGDB: Waiting for connection from remote gdb...
</code></pre></div></p>
<p><strong>On workstation:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>gdb<span class="w"> </span>vmlinux
</code></pre></div></p>
<p><strong>In GDB:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>(gdb) target remote /dev/ttyUSB0
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>Remote debugging using /dev/ttyUSB0
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>0xffff800010123456 in default_idle ()
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>(gdb) bt
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>#0  0xffff800010123456 in default_idle ()
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>#1  0xffff800010234567 in arch_cpu_idle ()
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>#2  0xffff800010345678 in do_idle ()
</code></pre></div></p>
<h3 id="53-set-breakpoints">5.3 Set Breakpoints<a class="headerlink" href="#53-set-breakpoints" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>(gdb) break sys_read
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>Breakpoint 1 at 0xffff800010456789: file fs/read.c, line 123.
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>(gdb) continue
</code></pre></div>
<p><strong>On BeaglePlay, trigger syscall:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>cat<span class="w"> </span>/etc/hostname
</code></pre></div></p>
<p><strong>GDB hits breakpoint:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>Breakpoint 1, sys_read (fd=3, buf=0xfffffffff8, count=1024) at fs/read.c:123
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>123     if (fd &lt; 0) return -EBADF;
</code></pre></div></p>
<h3 id="54-examine-kernel-state">5.4 Examine Kernel State<a class="headerlink" href="#54-examine-kernel-state" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>(gdb) print current-&gt;comm
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>$1 = &quot;cat&quot;
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>(gdb) print current-&gt;pid
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>$2 = 567
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>(gdb) x/20i $pc
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a># Disassemble current location
</code></pre></div>
<hr />
<h2 id="6-magic-sysrq-for-debugging">6. Magic SysRq for Debugging<a class="headerlink" href="#6-magic-sysrq-for-debugging" title="Permanent link">&para;</a></h2>
<h3 id="61-enable-magic-sysrq">6.1 Enable Magic SysRq<a class="headerlink" href="#61-enable-magic-sysrq" title="Permanent link">&para;</a></h3>
<p><strong>Boot parameter:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>sysrq_always_enabled=1
</code></pre></div></p>
<p><strong>Or at runtime:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nb">echo</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>&gt;<span class="w"> </span>/proc/sys/kernel/sysrq
</code></pre></div></p>
<h3 id="62-useful-sysrq-commands">6.2 Useful SysRq Commands<a class="headerlink" href="#62-useful-sysrq-commands" title="Permanent link">&para;</a></h3>
<p><strong>Via serial console:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>Alt+SysRq+&lt;key&gt;
</code></pre></div></p>
<p><strong>Or via /proc:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="nb">echo</span><span class="w"> </span>&lt;key&gt;<span class="w"> </span>&gt;<span class="w"> </span>/proc/sysrq-trigger
</code></pre></div></p>
<p><strong>Common keys:</strong>
- <strong>t</strong>: Dump task states (all processes)
- <strong>m</strong>: Dump memory info
- <strong>w</strong>: Dump blocked (waiting) tasks
- <strong>l</strong>: Dump all CPUs' backtraces
- <strong>p</strong>: Dump registers
- <strong>s</strong>: Sync filesystems
- <strong>u</strong>: Remount read-only
- <strong>b</strong>: Reboot immediately</p>
<p><strong>Example - show all tasks:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="nb">echo</span><span class="w"> </span>t<span class="w"> </span>&gt;<span class="w"> </span>/proc/sysrq-trigger
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-100
</code></pre></div></p>
<p><strong>Output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>bash            S 567     1  0x00000000
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>Call trace:
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a> __switch_to+0x80/0x100
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a> schedule+0x50/0x100
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a> schedule_timeout+0x80/0x150
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a> wait_for_completion+0x90/0x120
</code></pre></div></p>
<hr />
<h2 id="7-crash-dump-analysis">7. Crash Dump Analysis<a class="headerlink" href="#7-crash-dump-analysis" title="Permanent link">&para;</a></h2>
<h3 id="71-decode-code-bytes">7.1 Decode Code Bytes<a class="headerlink" href="#71-decode-code-bytes" title="Permanent link">&para;</a></h3>
<p><strong>From OOPS:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>Code: d2800000 d503201f 910003fd f9001fe0 (b9000000)
</code></pre></div></p>
<p><strong>Disassemble:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;d2800000 d503201f 910003fd f9001fe0 b9000000&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">  </span>xxd<span class="w"> </span>-r<span class="w"> </span>-p<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">  </span>aarch64-linux-gnu-objdump<span class="w"> </span>-D<span class="w"> </span>-b<span class="w"> </span>binary<span class="w"> </span>-m<span class="w"> </span>aarch64<span class="w"> </span>-
</code></pre></div></p>
<p><strong>Output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>   0:   d2800000    mov x0, #0x0
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>   4:   d503201f    nop
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>   8:   910003fd    mov x29, sp
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>   c:   f9001fe0    str x0, [sp, #56]
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>  10:   b9000000    str w0, [x0]   Crash here (store to x0=NULL)
</code></pre></div></p>
<h3 id="72-analyze-with-crash-utility">7.2 Analyze with crash Utility<a class="headerlink" href="#72-analyze-with-crash-utility" title="Permanent link">&para;</a></h3>
<p><strong>Install crash:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>crash
</code></pre></div></p>
<p><strong>Analyze vmcore:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>crash<span class="w"> </span>vmlinux<span class="w"> </span>vmcore
</code></pre></div></p>
<p><strong>Commands:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>crash&gt; bt       # Backtrace
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>crash&gt; ps       # Process list
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>crash&gt; log      # Kernel log
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>crash&gt; files    # Open files
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>crash&gt; vm       # Virtual memory
</code></pre></div></p>
<hr />
<h2 id="8-debugging-kernel-modules">8. Debugging Kernel Modules<a class="headerlink" href="#8-debugging-kernel-modules" title="Permanent link">&para;</a></h2>
<h3 id="81-load-module-with-debug-symbols">8.1 Load Module with Debug Symbols<a class="headerlink" href="#81-load-module-with-debug-symbols" title="Permanent link">&para;</a></h3>
<p><strong>Build module with debug:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="nv">EXTRA_CFLAGS</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span>-g<span class="w"> </span>-O0
</code></pre></div></p>
<p><strong>Load module:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>insmod<span class="w"> </span>my_module.ko
</code></pre></div></p>
<p><strong>Find module load address:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>cat<span class="w"> </span>/sys/module/my_module/sections/.text
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="c1"># 0xffff800012340000</span>
</code></pre></div></p>
<p><strong>In GDB:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>(gdb) add-symbol-file my_module.ko 0xffff800012340000
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>(gdb) break my_module_function
</code></pre></div></p>
<h3 id="82-printk-debugging">8.2 printk Debugging<a class="headerlink" href="#82-printk-debugging" title="Permanent link">&para;</a></h3>
<p><strong>Traditional but effective:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="n">printk</span><span class="p">(</span><span class="n">KERN_DEBUG</span><span class="w"> </span><span class="s">&quot;my_func: value=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>View output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>my_func
</code></pre></div></p>
<p><strong>Dynamic debug (preferred):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="n">pr_debug</span><span class="p">(</span><span class="s">&quot;my_func: value=%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>Enable at runtime:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;module my_module +p&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>/sys/kernel/debug/dynamic_debug/control
</code></pre></div></p>
<hr />
<h2 id="9-real-world-debugging-example">9. Real-World Debugging Example<a class="headerlink" href="#9-real-world-debugging-example" title="Permanent link">&para;</a></h2>
<h3 id="91-scenario-system-hangs">9.1 Scenario: System Hangs<a class="headerlink" href="#91-scenario-system-hangs" title="Permanent link">&para;</a></h3>
<p><strong>Symptoms:</strong> System becomes unresponsive.</p>
<p><strong>Step 1: Check if kernel is alive</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="c1"># Via SysRq</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="nb">echo</span><span class="w"> </span>l<span class="w"> </span>&gt;<span class="w"> </span>/proc/sysrq-trigger
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="c1"># If this works, kernel is running</span>
</code></pre></div></p>
<p><strong>Step 2: Dump all tasks</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="nb">echo</span><span class="w"> </span>t<span class="w"> </span>&gt;<span class="w"> </span>/proc/sysrq-trigger
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>dmesg<span class="w"> </span>&gt;<span class="w"> </span>/tmp/tasks.log
</code></pre></div></p>
<p><strong>Step 3: Find blocked tasks</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="nb">echo</span><span class="w"> </span>w<span class="w"> </span>&gt;<span class="w"> </span>/proc/sysrq-trigger
</code></pre></div></p>
<p><strong>Output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>task                PC      stack   pid father
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>my_daemon       D    0   567    1 0x00000000
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>Call trace:
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a> __switch_to+0x80/0x100
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a> schedule+0x50/0x100
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a> mutex_lock+0x40/0x80         Waiting for mutex
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a> my_driver_ioctl+0x30/0x100
<a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a> ksys_ioctl+0x80/0x120
</code></pre></div></p>
<p><strong>Analysis:</strong> <code>my_daemon</code> stuck waiting for mutex in driver.</p>
<p><strong>Step 4: Check lock holder</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="c1"># If PROVE_LOCKING enabled</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>cat<span class="w"> </span>/proc/lockdep
</code></pre></div></p>
<h3 id="92-fix-and-verify">9.2 Fix and Verify<a class="headerlink" href="#92-fix-and-verify" title="Permanent link">&para;</a></h3>
<p><strong>Add debug output to driver:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="n">pr_debug</span><span class="p">(</span><span class="s">&quot;Acquiring lock...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">driver_lock</span><span class="p">);</span>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="n">pr_debug</span><span class="p">(</span><span class="s">&quot;Lock acquired</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>Enable dynamic debug and reproduce.</strong></p>
<hr />
<h2 id="10-kernel-sanitizers">10. Kernel Sanitizers<a class="headerlink" href="#10-kernel-sanitizers" title="Permanent link">&para;</a></h2>
<h3 id="101-kasan-kernel-address-sanitizer">10.1 KASAN (Kernel Address Sanitizer)<a class="headerlink" href="#101-kasan-kernel-address-sanitizer" title="Permanent link">&para;</a></h3>
<p><strong>Detects:</strong>
- Use-after-free
- Out-of-bounds access
- Double-free</p>
<p><strong>Enable:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>CONFIG_KASAN=y
</code></pre></div></p>
<p><strong>Example detection:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>BUG: KASAN: use-after-free in my_func+0x80/0x100
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>Write of size 4 at addr ffff0000c1234000 by task my_task/567
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>Allocated by task 567:
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a> kasan_save_stack+0x20/0x40
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a> __kasan_kmalloc+0x80/0xa0
<a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a> my_func+0x20/0x100
<a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>
<a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a>Freed by task 567:
<a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a> kasan_save_stack+0x20/0x40
<a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a> kasan_set_free_info+0x20/0x30
<a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a> __kasan_slab_free+0x100/0x130
<a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a> kfree+0x80/0x200
<a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a> my_func+0x60/0x100
</code></pre></div></p>
<h3 id="102-ubsan-undefined-behavior-sanitizer">10.2 UBSAN (Undefined Behavior Sanitizer)<a class="headerlink" href="#102-ubsan-undefined-behavior-sanitizer" title="Permanent link">&para;</a></h3>
<p><strong>Detects:</strong>
- Integer overflow
- Null pointer arithmetic
- Out-of-bounds array access</p>
<p><strong>Enable:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>CONFIG_UBSAN=y
</code></pre></div></p>
<hr />
<h2 id="11-troubleshooting-tips">11. Troubleshooting Tips<a class="headerlink" href="#11-troubleshooting-tips" title="Permanent link">&para;</a></h2>
<h3 id="111-system-wont-boot">11.1 System Won't Boot<a class="headerlink" href="#111-system-wont-boot" title="Permanent link">&para;</a></h3>
<p><strong>Serial console shows panic:</strong>
1. Note panic message and call trace
2. Check if related to recent kernel/driver change
3. Revert change or add debug output
4. Use <code>initcall_debug</code> boot param to see init sequence</p>
<h3 id="112-intermittent-crashes">11.2 Intermittent Crashes<a class="headerlink" href="#112-intermittent-crashes" title="Permanent link">&para;</a></h3>
<p><strong>Hard to reproduce:</strong>
1. Enable all debug options
2. Add extensive logging
3. Use stress testing tools
4. Consider race condition (add locking debug)</p>
<hr />
<h2 id="12-key-takeaways">12. Key Takeaways<a class="headerlink" href="#12-key-takeaways" title="Permanent link">&para;</a></h2>
<p><strong>Accomplished:</strong>
1.  Decoded kernel OOPS messages
2.  Enabled kernel debug configs
3.  Used KGDB for interactive debugging
4.  Detected memory leaks with kmemleak
5.  Debugged deadlocks with lockdep
6.  Analyzed crashes with Magic SysRq</p>
<p><strong>Essential Skills:</strong>
- Read and understand kernel stack traces
- Use addr2line to find crash source
- Enable appropriate debug configs
- Use Magic SysRq for hung systems</p>
<p><strong>Next Steps:</strong>
- <strong>Lab 26</strong>: kdump and kexec for crash dumps</p>
<hr />
<h2 id="13-verification-checklist">13. Verification Checklist<a class="headerlink" href="#13-verification-checklist" title="Permanent link">&para;</a></h2>
<ul>
<li>[ ] Can decode kernel OOPS messages</li>
<li>[ ] Understand kernel debug configs</li>
<li>[ ] Can use KGDB for debugging</li>
<li>[ ] Can detect memory leaks</li>
<li>[ ] Can debug deadlocks</li>
<li>[ ] Can use Magic SysRq commands</li>
</ul>
<hr />
<p><strong>End of Lab 25</strong></p>
<p><em>The Guide rates this lab: </em><em>Mostly Harmless</em><em> </em></p>
<p>Kernel debugging is essential for developing robust drivers and system software. Understanding OOPS messages, using debug configs, and leveraging KGDB enables you to diagnose even the most challenging kernel issues.</p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="January 30, 2026 15:44:01 UTC">January 30, 2026</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="January 30, 2026 15:44:01 UTC">January 30, 2026</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Jofralso. Licensed under MIT.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Jofralso" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://buymeacoffee.com/jofralso" target="_blank" rel="noopener" title="Buy Me A Coffee" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M152-16c-13.3 0-24 10.7-24 24 0 38.9 23.4 59.4 39.1 73.1l1.1 1C184.5 96.4 192 103.9 192 120c0 13.3 10.7 24 24 24s24-10.7 24-24c0-38.9-23.4-59.4-39.1-73.1l-1.1-1C183.5 31.7 176 24.1 176 8c0-13.3-10.7-24-24-24M96 192c-17.7 0-32 14.3-32 32v192c0 53 43 96 96 96h192c41.8 0 77.4-26.7 90.5-64h5.5c70.7 0 128-57.3 128-128s-57.3-128-128-128zm352 192V256c35.3 0 64 28.7 64 64s-28.7 64-64 64M288 8c0-13.3-10.7-24-24-24S240-5.3 240 8c0 38.9 23.4 59.4 39.1 73.1l1.1 1C296.5 96.4 304 103.9 304 120c0 13.3 10.7 24 24 24s24-10.7 24-24c0-38.9-23.4-59.4-39.1-73.1l-1.1-1C295.5 31.7 288 24.1 288 8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>